---
title             : "NFC and burnout in teachers - A replication and extension study"
shorttitle        : "NFC and burnout in teachers"
author: 
  - name          : "Josephine Zerna"
    affiliation   : "1"
    orcid         : "0000-0003-2892-884X"
    corresponding : yes    # Define only one corresponding author
    address       : "Zellescher Weg 17, 01069 Dresden, Germany"
    email         : "josephine.zerna@tu-dresden.de"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Methodology
      - Formal analysis
      - Writing - original draft preparation
      - Writing - review & editing
  - name          : "Nicole Engelmann"
    affiliation   : "2"
    role:
      - Conceptualization
      - Investigation
      - Writing - review & editing
  - name          : "Anja Strobel"
    affiliation   : "3"
    orcid         : "0000-0002-0313-0615"
    role:
      - Conceptualization
      - Supervision
      - Methodology
      - Writing - review & editing
  - name          : "Alexander Strobel"
    affiliation   : "1"
    orcid         : "0000-0002-9426-5397"
    role:
      - Conceptualization
      - Supervision
      - Methodology
      - Writing - review & editing

affiliation:
  - id            : "1"
    institution   : "Faculty of Psychology, Technische Universität Dresden"
  - id            : "2"
    institution   : "Faculty of Education, Technische Universität Dresden"
  - id            : "3"
    institution   : "Institute of Psychology, Chemnitz University of Technology"

abstract: |
  The prevalence of burnout has been rising for years, not just due to the increasing demands during the Covid-19 pandemic.
  While it is known that burnout primarily affects employees in social jobs, less is known about the personality traits that promote or protect against burnout.
  One of these traits is Need for Cognition (NFC), the stable intrinsic motivation to seek out and enjoy effortful cognitive activities.
  In the present study, we analyzed questionnaire data of N = 180 teachers that had been collected in spring of 2020.
  Firstly, we aimed to replicate results by Grass et al. (2018), who showed that the association of NFC and the burnout aspect of reduced personal efficacy was mediated by habitual use of reappraisal, but not by habitual suppression or self-control.
  With our data, self-control became a significant mediator when teaching experience was being taken into account, but neither reappraisal nor suppression mediated between NFC and reduced personal efficacy.
  Secondly, we computed a structural equation model to investigate whether NFC and burnout were associated via different ratios of demands and personal resources, and included other variables in an exploratory approach.
  The results indicated that teachers with higher NFC and more self-control have lower burnout because they experience their resources as fitting to the demands.
  
keywords          : "mediation, resources, demands, structural equation modelling, Covid-19"
wordcount         : "~ 5600"
bibliography      : NFC_Burnout.bib
floatsintext      : yes
figsintext        : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
csl               : apa.csl
header-includes   :
    - \usepackage{booktabs}
    - \usepackage{longtable}
    - \usepackage{array}
    - \usepackage{multirow}
    - \usepackage{wrapfig}
    - \usepackage{float}
    - \usepackage{colortbl}
    - \usepackage{pdflscape}
    - \usepackage{tabu}
    - \usepackage{threeparttable}
    - \usepackage{threeparttablex}
    - \usepackage[normalem]{ulem}
    - \usepackage{makecell}
    - \usepackage{xcolor}
    - \usepackage{setspace}\doublespacing
    - \usepackage{chngcntr}
---
\renewcommand\thesection{\Alph{section}}
\counterwithout{figure}{section}
\counterwithout{table}{section}
\setcounter{figure}{0}
\setcounter{table}{0}

```{r setup, include = FALSE}

  # set the output for figures and tables to the width of the text throughout the entire script

  knitr::opts_chunk$set(out.width = "\\textwidth")

  # define required packages

  packages = c("bibtex", "here", "tidyverse", "bayestestR", "papaja", "lavaan", "psych", "MVN", "MBESS",
               "kableExtra", "Hmisc", "semPlot", "ggplot2", "knitr", "qgraph", "ppcor", "stats", "apa", "GGally")

  # check whether each package is installed and install and/or load library
  
  installed_packages <- packages %in% rownames(installed.packages())
  if (any(installed_packages == FALSE)) {
    install.packages(packages[!installed_packages])
  }
  invisible(lapply(packages, library, character.only = TRUE))

```

```{r analysispreferences, echo=FALSE, message=FALSE, warning=FALSE}

  # Seed for random number generation
  set.seed(13)
  knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
  
  # Set a number for the bootstrapping procedures
  bootnum <- 5000

```

# Introduction

Need for Cognition (NFC) is a stable intrinsic motivation to seek out and especially to enjoy effortful cognitive activities [@Cacioppo1982].
As it bridges the gap between cognition and motivation, NFC is considered to be an investment trait [@Stumm2013], and has come to the fore of psychological research in the last years.
NFC can easily be assessed using the Need for Cognition Scale (NCS), a self-report questionnaire with 18 to 34 items [@Cacioppo1982; @Cacioppo1984].
While many studies have found positive associations of NFC with academic performance [@Cazan2014; @Elias2002; @Grass2017; @Lavrijsen2021; @Zheng2020], recent investigations have also looked at NFC as a personal resource in academic and work contexts.
Individuals high in NFC have more positive emotions at the end of the work day [@Rosen2020], higher work motivation, perceive their roles as less ambiguous [@Nowlin2017], are less likely to drop out of college [@Grass2017; @Klaczynski1996], and have less anxiety regarding their course work [@Karagiannopoulou2020].
These findings suggest that individuals high in NFC might be less prone to experience adverse effects of work stress, which range from physical [@Dragano2017; @Steptoe2013] to psychological [@Madsen2017; @Maslach2016; @Wiesner2005].

One of these psychological consequences is burnout, a state of exhaustion and cynicism caused by long-term overstimulation in the workplace, which results in employees being dissatisfied, being sick more often, and performing poorly [@Schaufeli2014].
Burnout is especially prevalent in social jobs such as healthcare or teaching because the worker is always in conflict between advocating for their client and meeting the goals set by the employer [@GrayStanley2011; @Lloyd2002].
Lackritz [-@Lackritz2004] found that university teachers' burnout scores were higher the more students they had, the higher their teaching load was, and the more time they spent grading students' work.
Burnout is most often assessed using the Maslach Burnout Inventory (MBI) [@Maslach1997], a self-report questionnaire with three subscales: Emotional exhaustion, depersonalisation, and reduced personal efficacy.

Individuals with high burnout scores are often passive copers, high in neuroticism, low in self-esteem, and have an external locus of control [@Schaufeli2014].
NFC on the other hand is negatively associated with those variables [@Double2016; @Fleischhauer2019; @Ghorbani2004; @Grass2018; @Osberg1987], suggesting that people high in NFC are less prone to experience burnout.
This is supported by findings that NFC is negatively associated with burnout scores in adults [@Fleischhauer2019], students [@Fleischhauer2019; @Naderi2018], and teacher trainees [@Grass2018].
However, the associations of NFC with the sum score and the subscales of the MBI are not always consistent between these studies.
This is likely not caused by inaccurate measurement, since the validity of both NCS [@Bless1994; @Osberg1987; @Tolentino1990] and MBI [@Brady2021; @Kantas1997; @Schaufeli2001; @ValdiviaVazquez2021] has been demonstrated in multiple studies.
What is more likely is the influence of one or more other variables, moderating or mediating the association of NFC and burnout.
Grass et al. [-@Grass2018] investigated such a mediation and found that the relation of NFC and the MBI subscale reduced personal-efficacy was fully mediated by reappraisal, active coping, and passive coping, but not by suppression or self-control.
Reappraisal and suppression are two emotion regulation strategies, which refer to the cognitive reassessment of a stressor and the inhibition of emotional reactions, respectively [@Gross1998a].
The findings by Grass et al. [-@Grass2018] suggest that individuals high in NFC experience a weaker decline in personal efficacy in response to long-term stress because they actively reassess the situation in a way that reinforces their sense of self-efficacy and don't avoid dealing with the stressor.
One goal of this paper was to replicate the findings of Grass et al. [-@Grass2018] using a multiple mediation model on cross-sectional self-report data of teachers.
We expected NFC to be negatively associated with reduced personal efficacy via higher reappraisal scores, but not via suppression, via self-control, or directly.

Furthermore, we extended the analysis to other possible mediators.
These mediators were motivated by our own recent survey of the literature on NFC and well-being, which suggested that individuals high in NFC might not only have a high level of personal resources but also overestimate their own resources to a certain degree [@Zerna2021].
Only a balance of resources and demands results in personal well-being, while an imbalance threatens well-being, regardless of whether this imbalance is in favour of resources or demands [@Dodge2012].
Following the framework of Hobfoll [-@Hobfoll1989], resources can be objects with practical or status purpose, conditions like marriage or tenure, personality aspects like coping style, and energies such as time, money, or knowledge.
In the case of NFC, resources are from the categories personality and energies: Personality, because NFC is a trait, encompassing a curious, analytic, and passionate approach to challenges, and energies, because individuals high in NFC have been coping actively all their life, which enriches their level of experience and knowledge in approaching challenges [@Cacioppo1996].
These personal resources matter with regards to stress assessment (how the situation is appraised) and with regards to both coping and recovery [@Salanova2006].
We therefore investigated whether the association of NFC and burnout was mediated by different ratios of demands and resources; demands that are too high to be dealt with using one’s personal resources (DTH), demands that are too low for one’s personal resources (DTL), and a balanced fit of demands and resources (DRF).
Using the same data as for the replication, we computed a structural equation model (SEM) to assess the influence of these mediators.
Since individuals high in NFC are confident in their abilities [@Bye2009; @Ghorbani2004; @Heppner1983; @Klaczynski1996], we expected NFC to be negatively associated with DTH, positively associated with DTL, and positively associated with DRF.
And since burnout results from constant unpleasant activation by high demands, we expected it to be positively associated with DTH and negatively associated with DRF.
However, we had no hypothesis regarding the association of DTL and burnout, because even though DTL is akin to the concept of boredom and the consequences of boredom and burnout are very similar, burnout is a state with even lower activation and even more negative affect than boredom [@Schaufeli2014].
It has already been shown that the Covid-19 pandemic has exacerbated the rising prevalence of burnout [@Froebe2021], so we incorporated the degree of feeling burdened by the pandemic in an exploratory approach.

# Methods

We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study [@Simmons2012].
Our preregistration, the data, and the R Markdown document used to analyze the data and write this manuscript are available at [https://osf.io/36ep9/](https://osf.io/36ep9/).

```{r import, echo=FALSE, message=FALSE, warning=FALSE}
  # Define the top level as the one where this file lies
  # If the rest of the files follow the structure of the Github repository, everything will work
  # (Simply download the entire repository to any location on your computer)
  
  here::i_am("flag_top_level_NFCBurnout.txt")
  
  # Load the data file
  
  load(here("Data", "data.Rda"))
  
  # Load the internal consistencies (bootstrapping has been suppressed to save time on knitting)
  consistencies <- read_rds(here("Data", "consistencies.rds"))
  outlierconsistencies <- read_rds(here("Data", "outlierconsistencies.rds"))
  
  # create a vector of consistencies to be used as the diagonal in a table later
  consist_diag <- cbind(format(round(t(consistencies[2,2:11]), digits = 2), nsmall = 2), rep("(",10),
                        format(round(t(consistencies[5,2:11]), digits = 2), nsmall = 2), rep(")",10))
  # paste together to create the output "alpha(omega)"
  consist_diag <- apply(consist_diag[,c(1:4)], 1 ,paste, collapse = "")
  
```


## Participants
Teachers were recruited via social media, emails to colleagues of N.E., and to Saxon schools with the request to pass on the information.
All teachers were eligible, no payment was issued.
Of the $N=$ 278 participants, who started filling out the online survey, $N =$ `r nrow(data)` (`r round((table(data$gender)[1]/nrow(data))*100, digits = 1)`% female, aged 20 to 67 years) data sets were complete and those participants indicated to have answered truthfully.
All of them were currently teaching at a primary, secondary, comprehensive, or vocational school.
Data was collected between the 12th of June and the 24th of July 2020.
At this point, schools had been switching between digital and hybrid forms of teaching for at least three months due to the Covid-19 pandemic, causing additional stress for many teachers.

## Material
All questionnaires were used in their German form.
Burnout was assessed using the 21-item Maslach Burnout Inventory (MBI) [@Buessing1992], NFC using the 16-item Need for Cognition Scale (NCS) [@Bless1994], self-control using the 13-item Self-Control Scale (SCS) [@Bertrams2009a], reappraisal and suppression using the 10-item Emotion Regulation Questionnaire (ERQ) [@Abler2009], and work satisfaction using the Allgemeine Arbeitszufriedenheit questionnaire [@Fischer2014].
Eleven items were created to assess each participant's current burden by the Covid-19 pandemic, such as whether they belong to a risk group or whether they currently had a higher workload.
The translated Covid-19 items can be found in the *Supplementary Material S1*.
The survey also included the Subjective Wellbeing Index of the World Health Organization [@Braehler2007], which we will not analyze.
Due to a technical error during survey setup, the coping style data of the Erfurter Belastungsinventar [@BoehmKasper2001] could not be used, so we could not replicate the mediation of NFC and burnout by active and passive coping.

## Procedure
The questionnaires were provided online using SoSci Survey [@Leiner2019].
Participants were informed about aims and duration of the study and data security, provided demographic information, answered the questionnaires, and could optionally enter their email address to be informed about the results of the analysis of N.E.'s thesis.

## Data analysis
We used *R Studio* [@RCT2020; @RStudioTeam2020] with the main packages *lavaan* [@Rosseel2012] and *psych* [@Revelle2021] for all our analyses.
Data were checked for multivariate normality using Mardia's coefficient.
To account for non-linear relationships, correlations were computed using Spearman's rank coefficient rather than Pearson's product moment correlation.
Internal consistencies were assessed with Cronbach's Alpha and MacDonald's Omega.
Since Cronbach's Alpha has been criticized for being insensitive to violations of internal consistency [@Dunn2014; @Taber2018], the additional computation of MacDonald's Omega has the purpose of ensuring a more reliable estimation.

### Replication of Grass et al. (2018)
Items were reverse coded according to the scale manuals.
NFC and self-control were computed as the sum scores of the NCS and the SCS, respectively.
Reduced personal efficacy was computed using the sum of the MBI subscale, and reappraisal and suppression were computed using the sum of each ERQ subscale.
NFC was entered as the independent variable, having a direct and multiple indirect effects on MBI via self-control, reappraisal, and suppression as mediators.
Following Grass et al. [-@Grass2018], the results of the model were appraised by using $N$ = 2,000 bootstrap samples for confidence intervals.
Multiple indices were used to evaluate model fit as recommended by Hu and Bentler [-@Hu1999]: the Chi-square test statistic, which measures the fit compared to a saturated model, the Comparative Fit Index (CFI), which compares the fit to the baseline model, the Standardized Root Mean Square Residual (SRMR), which compares the residuals of the observed and predicted covariance matrix, and the Root Mean Square Error of Approximation (RMSEA), which does the same as the latter but takes degrees of freedom and model complexity into account.

### Demand-resource-ratio model
All items, apart from those making up the demand-resource-ratios, were reverse coded according to the scale manuals.
The latent factor NFC was computed by subjecting the NCS items to a parcelling procedure following Grass et al. [-@Grass2019], a method that is used in SEM when only relations between but not within constructs are of interest.
Principal component analysis was used to determine the factor loadings of each NCS item onto the first component.
Then, the items were randomly divided into four parcels and the average item loading per parcel was computed.
This was repeated 10,000 times to find the parcelling choice with the smallest difference in average item loadings between parcels.
The latent factor MBI was computed using the three subscales as indicators.
For the demand-resource-ratios, we used three items from the work satisfaction scale each.
The latent factor DTH was indicated by items 4, 8, and 9, DTL by the recoded items 12, 26, and 27, and DRF by items 17, 22, and 24.
The items can be translated as follows: 4) "There is too much pressure on me.", 8) "There is often too much being demanded of us at work.", 9) "I often feel tired and weary because of my work.", 12) "I can realize my ideas here.", 17) "I take pleasure in my work.", 22) "Does your place of work give you the opportunity to do what you do best?", 24) "Does your place of work give you enough opportunities to use your skills?", 26) "Are you happy with your promotion prospects?", and 27) "Are you happy with your position when comparing it to your skills?".
Model parameters were estimated using the maximum likelihood method with robust standard errors.
Model fit was evaluated by looking at the Chi-square test statistic, CFI, SRMR, and RMSEA.

### Exploratory analyses
We preregistered two exploratory analyses.
Firstly, we repeated the SEM with the subscale reduced personal efficacy in place of the MBI score, since this subscale has shown higher correlations with NFC than the other subscales [@Grass2018; @Naderi2018].
And secondly, we included a Covid-19 burden score into the SEM, computed as the sum of the Covid-19 items.

```{r splitandrecode, echo=FALSE, message=FALSE, warning=FALSE}

  # Put questionnaire data into different data frames for easy access
  
  mbi <- data[,grep("MBI", colnames(data))]   # Maslach Burnout Inventory
  erq <- data[,grep("ERQ", colnames(data))]   # Emotion Regulation Questionnaire
  scs <- data[,grep("SCS", colnames(data))]   # Self Control Scale
  ws <- data[,grep("WS", colnames(data))]     # Work Satisfaction
  ncs <- data[,grep("NCS", colnames(data))]   # Need for Cognition Scale
  ncs <- ncs[,-9]                             # remove the dummy item
  covb <- data[,grep("COV", colnames(data))]  # Covid Burden Items
  dth <- ws[,c(4,8,9)]                        # the Work Satisfaction items for the latent variable Demands Too High
  dtl <- ws[,c(12,26,27)]                     # the Work Satisfaction items for the latent variable Demands Too Low
  drf <- ws[,c(17,21,24)]                     # the Work Satisfaction items for the latent variable Demand-Resource-Fit
  
  # Create a list with keys for the questionnaire subscales/latent variables/item parcels
  
  keylist <- list(mbi_ee = c(5,7,10,11,14,18,19,20,21), mbi_dp = c(1,6,9,15,17), mbi_rpe = c(2,3,4,8,12,13,16),
                  erq_supp = c(2,4,6,9), erq_reap = c(1,3,5,7,8,10),
                  scs = c(2,3,4,5,6,7,8,10,11),
                  ncs = c(4,6,7,8,9,10,11,12,15,16),
                  ws = c(4,5,6,8,9,10,11,13,16,19,20,33))
  
  # Recode all the reverse coded items
  
  mbi[,keylist$mbi_rpe] <- 7 - mbi[,keylist$mbi_rpe]  # Recode from 1-6 to 6-1
  scs[,keylist$scs] <- 6 - scs[,keylist$scs]          # Recode from 1-5 to 5-1
  scs <- scs - 3                                      # Recode all from 1-5 to -2-+2
  ncs[,keylist$ncs] <- 8 - ncs[,keylist$ncs]          # Recode from 1-7 to 7-1
  ncs <- ncs - 4                                      # Recode all from 1-7 to -3-+3
  ws[,keylist$ws] <- 6 - ws[,keylist$ws]              # Recode from 1-5 to 5-1
  ws <- ws - 3                                        # Recode all from 1-5 to -2-+2
  covb[,c(2,3,4,9)] <- 4 - covb[,c(2,3,4,9)]          # Recode from 1-3 to 3-1
  covb[,8] <- 3 - covb[,8]                            # Recode from 1-2 to 2-1
  # The following recoding is opposite to what is described in the methods section of the paper, which
  # is due to the fact that the questionnaire is originally coded as 1 (false) to 5 (true), but it was
  # coded as 1 (true) to 5 (false) in the SoSciSurvey of the present study.
  dth <- 6 - dth                                      # Recode all from 1-5 to 5-1
  dth <- dth - 3                                      # Recode all from 1-5 to -2-+2
  dtl <- dtl - 3                                      # Recode all from 1-5 to -2-+2
  drf <- 6 - drf                                      # Recode all from 1-5 to 5-1
  drf <- drf -3                                       # Recode all from 1-5 to -2-+2

```

```{r parcelling, echo=FALSE, message=FALSE, warning=FALSE}

  # Parcelling preparation: Compute factor loadings on the first PCA component
  
  ncs_pca <- princomp(ncs, cor = FALSE, scores = TRUE)
  ncs_load <- ncs_pca$loadings[,1]
  
  # Parcelling function
  
  parcel.gen <- function(loadings, parcels = 4,seed = 242,iterations = 10000) {
    
    p = parcels                   # number of parcels
    l = length(loadings)          # number of items
    set.seed(seed)              # seed for reproducibility
    
    out = parcels = NULL            # set up containers
    for (k in 1:iterations) {
      
      s = sample(1:l,l,replace = F) # random item order
      m = matrix(s,ncol = 4)        # separate into parcels
      
      # temporarily convert item numbers per parcel to concatenated strings
      parcels.i = NULL
      for (i in 1:p) {
        parcels.i = c(parcels.i,paste0(sort(m[,i]),collapse = ","))
      }
      # write to container
      parcels = rbind(parcels,parcels.i)
      
      # compute average item loadings per parcel
      avg.h = colMeans(matrix(loadings[m],ncol = 4))
      
      # compute differences between all average item loadings
      h.diff = NULL
      for (i in 1:(p-1)) {
        for (j in (i+1):p) {
          h.diff = c(h.diff,abs(avg.h[i]-avg.h[j]))
        }
      }
      
      # sum up differences
      h.diff.sum = sum(h.diff)
      # write summed differences to container
      out = c(out,h.diff.sum)
    }
    
    # find minimum summed difference and generate matrix or respective items
    final.parcels = matrix(as.numeric(unlist(strsplit(parcels[which.min(out),],','))),ncol = 4)
    # obtain corresponding loadings per parcel
    final.h = matrix(loadings[final.parcels],ncol = 4)
    
    # return result as list
    return(list(items = final.parcels,loadings = final.h,avg.loadings = colMeans(final.h),summed.difference = min(out)))
    
  }
  
  ncs_parcels <- parcel.gen(loadings = ncs_load) # execute function
  
  # Add parcelling result to the key list
  
  keylist <- c(keylist, parcel1 = list(ncs_parcels$items[,1]), parcel2 = list(ncs_parcels$items[,2]),
               parcel3 = list(ncs_parcels$items[,3]), parcel4 = list(ncs_parcels$items[,4]))
```

```{r scores, echo=FALSE, message=FALSE, warning=FALSE, fig.show='hide'}

# Create data frame to feed the values of every subject into
  
  score_data <- data.frame(id = c(1:180),
                           years = data$yearsteaching,
                           mbi = rep(0,180),
                           mbi_ee = rep(0,180), mbi_dp = rep(0,180), mbi_rpe = rep(0,180),
                           erq = rep(0,180),
                           erq_supp = rep(0,180), erq_reap = rep(0,180),
                           scs = rep(0,180),
                           ncs = rep(0,180),
                           nfc1 = rep(0,180), nfc2 = rep(0,180), nfc3 = rep(0,180), nfc4 = rep(0,180),
                           dth = rep(0,180),
                           dth1 = rep(0,180), dth2 = rep(0,180), dth3 = rep(0,180),
                           dtl = rep(0,180),
                           dtl1 = rep(0,180), dtl2 = rep(0,180), dtl3 = rep(0,180),
                           drf = rep(0,180),
                           drf1 = rep(0,180), drf2 = rep(0,180), drf3 = rep(0,180),
                           covb = rep(0,180))
  
  # Compute individual scores or (for the latent variable indicators) feed in raw values
  
  for (i in 1:nrow(data)) {
    score_data[i,c(3:ncol(score_data))] <- c(rowSums(mbi[i,]),
                                             rowSums(mbi[i,keylist$mbi_ee]), rowSums(mbi[i,keylist$mbi_dp]), rowSums(mbi[i,keylist$mbi_rpe]),
                                             rowSums(erq[i,]),
                                             rowSums(erq[i,keylist$erq_supp]), rowSums(erq[i,keylist$erq_reap]),
                                             rowSums(scs[i,]),
                                             rowSums(ncs[i,]),
                                             rowSums(ncs[i,keylist$parcel1]), rowSums(ncs[i,keylist$parcel2]), rowSums(ncs[i,keylist$parcel3]), rowSums(ncs[i,keylist$parcel4]),
                                             rowSums(dth[i,]),
                                             dth[i,1], dth[i,2], dth[i,3],
                                             rowSums(dtl[i,]),
                                             dtl[i,1], dtl[i,2], dtl[i,3],
                                             rowSums(drf[i,]),
                                             drf[i,1], drf[i,2], drf[i,3],
                                             rowSums(covb[i,]))
  }

  # This function was taken from an answer on a Stackoverflow question on August 30th 2021
  # https://stackoverflow.com/questions/35085261/how-to-use-loess-method-in-ggallyggpairs-using-wrap-function/35088740

  my_fn <- function(data, mapping, pts=list(), smt=list(), ...){
    ggplot(data = data, mapping = mapping, ...) +
      do.call(geom_point, pts) +
      do.call(geom_smooth, smt)
  }
  
  # Plot a big correlational matrix to check for non-linear associations and unexpected outliers
  multicorrplot <- ggpairs(score_data[,c("years","mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap",
                                         "scs","ncs","dth","dtl","drf","covb")], lower = list(continuous = my_fn))

  # It looked like there was an outlier in the data, especially visible in the MBI data
  # Check for the outlier in particular, using the data involved in the mediation
  outlierplot <- outlier(score_data[ ,c(6,8:11)], plot = TRUE)
  
  # Remove participant 161 in a second version of the data frame (for the supplementary material analysis)
  score_data_no_outlier <- score_data[score_data$mbi < 100, ]
  
```

```{r descriptives, echo=FALSE, message=FALSE, warning=FALSE}

  # Tests for normal distribution

    # using Mardia's test for multivariate normal distribution
    # results will be fed into the desc_met data frame in the next step
  
    isnorm_test <- mvn(score_data[c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap","scs","ncs","dth","dtl","drf","covb")],
                       mvnTest = "mardia", covariance = TRUE, desc = TRUE, univariateTest = "SW")  
  
  # Descriptive statistics
  
    # Categorical descriptives: data frame with percentages of responses per category
    
    desc_cat <- data.frame(answer = c(1,2,3,4,5),
                           age = c(nrow(data[data$age == 1,])/nrow(data), nrow(data[data$age == 2,])/nrow(data), nrow(data[data$age == 3,])/nrow(data),
                                   nrow(data[data$age == 4,])/nrow(data), nrow(data[data$age == 5,])/nrow(data)),
                           gender = c(nrow(data[data$gender == 1,])/nrow(data), nrow(data[data$gender == 2,])/nrow(data), nrow(data[data$gender == 3,])/nrow(data),0,0),
                           schooltype = c(nrow(data[data$schooltype == 1,])/nrow(data), nrow(data[data$schooltype == 2,])/nrow(data), nrow(data[data$schooltype == 3,])/nrow(data),
                                          nrow(data[data$schooltype == 4,])/nrow(data), nrow(data[data$schooltype == 5,])/nrow(data)))
    
    # Metric descriptives: data frame with descriptive values of questionnaires
    
    desc_met <- data.frame(Variable = c("MBI","MBI EE","MBI DP","MBI RPE","ERQ","ERQ S","ERQ R","SCS","NFC","DTH","DTL","DRF","COV"),
                           Minimum = sapply(score_data[,c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap","scs","ncs","dth","dtl","drf","covb")], min),
                           Maximum = sapply(score_data[,c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap","scs","ncs","dth","dtl","drf","covb")], max),
                           Mean = isnorm_test$Descriptives$Mean,
                           SD = isnorm_test$Descriptives$Std.Dev,
                           Normality = isnorm_test$univariateNormality$Normality,
                           Skewness = isnorm_test$Descriptives$Skew,
                           Kurtosis = isnorm_test$Descriptives$Kurtosis)
    # Drop the row names
    
    rownames(desc_met) <- NULL
    
    # Replace the capital YESes and NOs with small ones
    
    desc_met$Normality[grep("NO", desc_met$Normality)] <- "No"
    desc_met$Normality[grep("YES", desc_met$Normality)] <- "Yes"
    
    # Round the values
    
    desc_met[ ,c("Mean","SD","Skewness","Kurtosis")] <- round(desc_met[ ,c("Mean","SD","Skewness","Kurtosis")], digits = 2)
    
    # Put the information in a table
    
    desc_table <-
      kbl(desc_met,
          caption = "Descriptive statistics of the questionnaire scores.",
          booktabs = T, # no vertical lines
          escape = F, # correctly print special characters
          align = c("l",rep("r",7))) %>% # right aligns the text in every column except for the first
      kable_styling(latex_options = c("striped", "scale_down")) %>%
      footnote(general = "MBI = Maslach Burnout Inventory, MBI EE = Emotional exhaustion subscale, MBI DP = Depersonalisation subscale, MBI RPE = Reduced personal efficacy subscale, ERQ = Emotion Regulation Questionnaire, ERQ S = Suppression subscale, ERQ R = Reappraisal subscale, SCS = Self-Control Scale, NFC = Need for Cognition, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand-Resource-Fit, COV = Covid-19 Burden, SD = Standard deviation. \\\\textit{N} = 180.",
               escape = F, # correctly print special characters
               threeparttable = T) # line breaks in the footnote

```

```{r consistency, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}

  # Tests for internal consistency

    # Create data frame to feed values into

    consistencies <- data.frame(value = c("lower CI alpha","raw alpha","upper CI alpha",
                                          "lower CI omega","raw omega","upper CI omega"))

    # Compute Cronbach's Alpha and MacDonald's Omega for questionnaires and demand-resource-ratios

    set.seed(13) # seed for reproducing the bootstrapping
    
    # Maslach Burnout Inventory
    
    cronalph <- alpha(mbi, check.keys = TRUE)
    macomega <- ci.reliability(data=mbi, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$mbi <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI emotional exhaustion
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_ee), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi, select = keylist$mbi_ee), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$mbi_ee <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI depersonalization
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_dp), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi, select = keylist$mbi_dp), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$mbi_dp <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI reduced personal efficacy
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_rpe), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi, select = keylist$mbi_rpe), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$mbi_rpe <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ
    
    cronalph <- alpha(erq, check.keys = TRUE)
    macomega <- ci.reliability(data=erq, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$erq <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ suppression
    
    cronalph <- alpha(subset(erq, select = keylist$erq_supp), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(erq, select = keylist$erq_supp), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$erq_supp <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ reappraisal
    
    cronalph <- alpha(subset(erq, select = keylist$erq_reap), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(erq, select = keylist$erq_reap), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$erq_reap <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Self Control Scale
    
    cronalph <- alpha(scs, check.keys = TRUE)
    macomega <- ci.reliability(data=scs, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$scs <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Need for Cognition Scale
    
    cronalph <- alpha(ncs, check.keys = TRUE)
    macomega <- ci.reliability(data=ncs, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$ncs <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Covid burden
    
    cronalph <- alpha(covb, check.keys = TRUE)
    macomega <- ci.reliability(data=covb, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$covb <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demands Too High
    
    cronalph <- alpha(dth, check.keys = FALSE)
    macomega <- ci.reliability(data=dth, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$dth <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demands Too Low
    
    cronalph <- alpha(dtl, check.keys = FALSE)
    macomega <- ci.reliability(data=dtl, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$dtl <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demand Resource Fit
    
    cronalph <- alpha(drf, check.keys = FALSE)
    macomega <- ci.reliability(data=drf, type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    consistencies$drf <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    remove(cronalph,macomega) # delete the temporary variable
    
```

```{r correlations, echo=FALSE, message=FALSE, warning=FALSE}
    
    # The following function for nicely formatted correlation output was taken from
    # https://paulvanderlaken.com/2020/07/28/publication-ready-correlation-matrix-significance-r/
    # on the 5th of August 2021

    correlation_matrix <- function(df,
                                   type = "spearman",
                                   digits = 3,
                                   decimal.mark = ".",
                                   use = "all",
                                   show_significance = TRUE,
                                   replace_diagonal = FALSE,
                                   replacement = ""){
      # check arguments
      stopifnot({
        is.numeric(digits)
        digits >= 0
        use %in% c("all", "upper", "lower")
        is.logical(replace_diagonal)
        is.logical(show_significance)
        is.character(replacement)
      })
      # we need the Hmisc package for this
      require(Hmisc)
      
      # retain only numeric and boolean columns
      isNumericOrBoolean = vapply(df, function(x) is.numeric(x) | is.logical(x), logical(1))
      if (sum(!isNumericOrBoolean) > 0) {
        cat('Dropping non-numeric/-boolean column(s):', paste(names(isNumericOrBoolean)[!isNumericOrBoolean], collapse = ', '), '\n\n')
      }
      df = df[isNumericOrBoolean]
      
      # transform input data frame to matrix
      x <- as.matrix(df)
      
      # run correlation analysis using Hmisc package
      correlation_matrix <- Hmisc::rcorr(x, type = type)
      R <- correlation_matrix$r # Matrix of correlation coeficients
      p <- correlation_matrix$P # Matrix of p-value 
      
      # transform correlations to specific character format
      Rformatted = formatC(R, format = 'f', digits = digits, decimal.mark = decimal.mark)
      
      # if there are any negative numbers, we want to put a space before the positives to align all
      if (sum(!is.na(R) & R < 0) > 0) {
        Rformatted = ifelse(!is.na(R) & R > 0, paste0(" ", Rformatted), Rformatted)
      }
    
      # add significance levels if desired
      if (show_significance) {
        # define notions for significance levels; spacing is important.
        stars <- ifelse(is.na(p), "", ifelse(p < .001, "***", ifelse(p < .01, "**", ifelse(p < .05, "*", ""))))
        Rformatted = paste0(Rformatted, stars)
      }
      
      # make all character strings equally long
      max_length = max(nchar(Rformatted))
      Rformatted = vapply(Rformatted, function(x) {
        current_length = nchar(x)
        difference = max_length - current_length
        return(paste0(x, paste(rep(" ", difference), collapse = ''), sep = ''))
      }, FUN.VALUE = character(1))
      
      # build a new matrix that includes the formatted correlations and their significance stars
      Rnew <- matrix(Rformatted, ncol = ncol(x))
      rownames(Rnew) <- colnames(Rnew) <- colnames(x)
      
      # replace undesired values
      if (use == 'upper') {
        Rnew[lower.tri(Rnew, diag = replace_diagonal)] <- replacement
      } else if (use == 'lower') {
        Rnew[upper.tri(Rnew, diag = replace_diagonal)] <- replacement
      } else if (replace_diagonal) {
        diag(Rnew) <- replacement
      }
      
      return(Rnew)
    }
    
    
    # correlate variables
    correlations <- correlation_matrix(score_data[c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap",
                                                    "scs","ncs","dth","dtl","drf","covb")],
                                       type = "spearman",
                                       use = "lower",
                                       show_significance = FALSE,
                                       replace_diagonal = TRUE,
                                       replacement = "")
    
    # reorder the columns of the consistencies data frame to match the correlation columns
    consist_diag <- consistencies[c(colnames(correlations))]
    
    # create a vector of consistencies to be used as the diagonal in a table later
    consist_diag <- cbind(format(round(t(consist_diag[2,]), digits = 2), nsmall = 2), rep("(",10),
                          format(round(t(consist_diag[5,]), digits = 2), nsmall = 2), rep(")",10))
    
    # paste together to create the output "alpha(omega)"
    consist_diag <- apply(consist_diag[,c(1:4)], 1 ,paste, collapse = "")
    
    # add previously assembled diagonal with alpha and omega values
    diag(correlations) <- consist_diag
    
    # set row and column names for better table printing
    row.names(correlations) <- c("1. MBI","2. MBI EE","3. MBI DP","4. MBI RPE","5. ERQ","6. ERQ S","7. ERQ R",
                                 "8. SCS","9. NFC","10. DTH","11. DTL","12. DRF","13. COV")
    colnames(correlations) <- c("1","2","3","4","5","6","7","8","9","10","11","12","13")
    
    # create array with p-values of correlation coefficients
    corr_pvalues <- rcorr(as.matrix(score_data[c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap",
                                                 "scs","ncs","dth","dtl","drf","covb")]), type = "spearman")$P
    # replace upper triangle with NA
    corr_pvalues[upper.tri(corr_pvalues, diag = TRUE)] <- NA
    
    # replace p-values with asterisks depending on significance level
    corr_pvalues <- ifelse(is.na(corr_pvalues), "", ifelse(corr_pvalues < .001, "***", ifelse(corr_pvalues < .01, "**", ifelse(corr_pvalues < .05, "*", ""))))
    
    # convert to matrix for the paste()-function
    correlations <- as.matrix(correlations)
    corr_pvalues <- as.matrix(corr_pvalues)
    
    # paste correlations and asterisks together
    correlations <- matrix(paste(correlations, corr_pvalues, sep = ""),
                           nrow = nrow(correlations), dimnames = dimnames(correlations))
    
```

# Results

During visual inspection of correlation plots we noticed an unexpected outlier with very high MBI scores and very low NFC scores.
A Q-Q-plot contrasting Mahalanobis *D^2^* against expected Chi Square values confirmed the outlier.
To adhere to the preregistration, we report the results containing the outlier in this section and the results excluding the outlier in the *Supplementary Material S2*.

```{r correlationstable, echo=FALSE, message=FALSE, warning=FALSE, caption="Correlations and internal consistencies"}

  corr_table <-
  kbl(correlations,
      caption = "Spearman correlations and internal consistencies of the questionnaire scores.",
      booktabs = TRUE, # no vertical lines
      escape = FALSE, # correctly print special characters
      align = rep("l",14)) %>% # left aligns the text in every column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    footnote(general = "MBI = Maslach Burnout Inventory, MBI EE = Emotional exhaustion subscale, MBI DP = Depersonalisation subscale, MBI RPE = Reduced personal efficacy subscale, ERQ = Emotion Regulation Questionnaire, ERQ S = Suppression subscale, ERQ R = Reappraisal subscale, SCS = Self-Control Scale, NFC = Need for Cognition, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand-Resource-Fit, COV = Covid-19 Burden. \\\\textit{N} = 180. * \\\\textit{p} < .05. ** \\\\textit{p} < .01. *** \\\\textit{p} < .001. Diagonal is Cronbach's Alpha and (in brackets) MacDonald's Omega.",
             escape = FALSE, # correctly print special characters
             threeparttable = TRUE) %>% # line breaks in the footnote
  kableExtra::landscape() # make the table horizontal 

```

## Descriptive statistics

Basic metric descriptives of the questionnaire scores and subscales are listed in Table 1.
Only the ERQ sum score and its reappraisal subscale followed a multivariate normal distribution, so the results of the models should be interpreted with some caution and with a focus on indices that are robust against violation of normality, such as the Satorra-Bentler or Yuan-Bentler-scaled test statistics [@Rosseel2012].

`r desc_table`

Correlations and internal consistencies are displayed in Table 2.
For this descriptive analysis, the variables DTH, DTL, and DRF were computed as a sum of their item scores, not weighted as in the structural equation model.
Using traditional cut-off values [@Nunnally1994], the Cronbach's Alpha of the three demand-resource-ratios can be considered *acceptable*.
The more robust MacDonald's Omega [@Dunn2014] did not deviate much from Cronbach's Alpha and indicated *acceptable* to *good* internal consistency.
As expected, the MBI score was positively correlated with DTH (`r cor_apa(cor.test(score_data$mbi, score_data$dth, method = "spearman", exact = FALSE), format = "rmarkdown", print = FALSE)`) and negatively with DRF (`r cor_apa(cor.test(score_data$mbi, score_data$drf, method = "spearman", exact = FALSE), format = "rmarkdown", print = FALSE)`), large associations according the classification scheme by Gignac and Szodorai [-@Gignac2016].
Surprisingly, the correlation between the MBI score and DTL was positive and also large (`r cor_apa(cor.test(score_data$mbi, score_data$dtl, method = "spearman", exact = FALSE), format = "rmarkdown", print = FALSE)`).
The NFC score correlated negatively with the MBI sum score and about equally with all subscales, contrary to some previous observations in other studies.

`r corr_table`

```{r objective1, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

  # Replication of Grass et al. (2018)
  
  repli_model <- '
  # direct paths
    scs       ~   a1 * ncs
    erq_reap  ~   a2 * ncs
    erq_supp  ~   a3 * ncs
    mbi_rpe   ~   b1 * scs + b2 * erq_reap + b3 * erq_supp + c * ncs
    
  # indirect effects
    Indirect1 := a1 * b1
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3)
'
  
  # Determine the model fit
  
  fit <- sem(
    model = repli_model,
    data  = score_data,
    se = "bootstrap",
    bootstrap = 2000
  )
  
  # Get summary
  
  fit_summ <- summary(fit, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
```

```{r objective1table, echo=FALSE, message=FALSE, warning=FALSE, caption="Results of the replication of Grass et al. (2018)"}

  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  replic_table <- data.frame("Path" = c("NFC on Self Control", "NFC on Reappraisal", "NFC on Suppression",
                                   "Self Control on RPE", "Reappraisal on RPE", "Suppression on RPE", "NFC on RPE",
                                   "NFC on RPE via Self Control", "NFC on RPE via Reappraisal", "NFC on RPE via Suppression",
                                   "Total Effect"),
                          "$B$" = c(fit_summ$PE$est[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "$SE$" = c(fit_summ$PE$se[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(fit_summ$PE$z[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(fit_summ$PE$pvalue[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(fit_summ$PE$ci.lower[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(fit_summ$PE$ci.upper[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(fit_summ$PE$std.all[fit_summ$PE$label != "" & fit_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  replic_table[2:ncol(replic_table)] <- format(round(replic_table[2:ncol(replic_table)], digits = 3), nsmall = 2)

  replic_table <-
    kbl(replic_table,
        caption = "Results of the replication of Grass et al. (2018).",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 7) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 8, 10) %>%
    pack_rows("Total Effect", 11, 11) %>%
    footnote(general = "$B$ = unstandardized regression coefficient, \\beta = standardized regression coefficient, $CI$ = confidence interval, NFC = Need for Cognition, RPE = reduced personal efficacy subscale of the Maslach Burnout Inventory, $SE$ = standard error.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
  
```

## Replication of Grass et al. (2018)

In order to replicate findings by Grass et al. [-@Grass2018] we computed a multiple mediation model to investigate whether the association of NFC and reduced personal efficacy was partially mediated by self-control and habitual use of reappraisal and suppression, respectively.
The baseline model did not fit the data ($\chi$^2^(`r round(fit_summ$FIT[["baseline.df"]], digits = 0)`, $N=$ `r nrow(data)`) = `r round(fit_summ$FIT[["baseline.chisq"]], digits = 2)`, $p < .001$).
Applying the cutoffs by Hu and Bentler [-@Hu1999] to the fit indices of $CFI=$ `r round(fit_summ$FIT[["cfi"]], digits = 2)`, $TLI=$ `r round(fit_summ$FIT[["tli"]], digits = 2)`, $SRMR=$ `r round(fit_summ$FIT[["srmr"]], digits = 2)`, and $RMSEA=$ `r format(round(fit_summ$FIT[["rmsea"]], digits = 2), nsmall = 2)`, 95% $CI$ [`r round(fit_summ[["FIT"]][["rmsea.ci.lower"]], digits = 2)`,`r round(fit_summ[["FIT"]][["rmsea.ci.upper"]], digits = 2)`], suggested good fit of the proposed model throughout all indices.
Standardized estimates are displayed in Figure 1, total, direct, and indirect effects are listed in Table 3.
We could replicate a positive association of NFC and self control ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "a1"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "a1"], digits = 3)`), and a negative association of habitual reappraisal and reduced personal efficacy ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "b2"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "b2"], digits = 3)`).
However, we could neither replicate the effect of NFC on reappraisal ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "a2"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "a2"], digits = 3)`), nor the indirect effect of NFC on reduced personal efficacy via reappraisal ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "Indirect2"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "Indirect2"], digits = 3)`).
Furthermore, even though NFC and reduced personal efficacy were both associated with self-control, the indirect effect of NFC on reduced personal efficacy via self control did not reach significance ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "Indirect1"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "Indirect1"], digits = 3)`).
Additionally, NFC was negatively associated with habitual use of suppression ($\beta=$ `r round(fit_summ$PE$std.all[fit_summ$PE$label == "a3"], digits = 2)`, $p=$ `r round(fit_summ$PE$pvalue[fit_summ$PE$label == "a3"], digits = 3)`), which was not the case in the study by Grass et al. [-@Grass2018].

```{r objective1plot, echo=FALSE, message=FALSE, warning=FALSE, fig.pos="H", fig.cap="Standardized regression coefficients in the replication of Grass et al. (2018). * $p<.05$, ** $p<.01$."}

  # create an array of standardized parameters and an array of significances
  
  fit_param <- fit_summ$PE$std.all[1:7]
  fit_sign <- fit_summ$PE$pvalue[1:7]

  # replace p-values with asterisks depending on significance level
  
  fit_sign <- ifelse(fit_sign < .001, "***", ifelse(fit_sign < .01, "**", ifelse(fit_sign < .05, "*", "")))
  
  # paste correlations and asterisks together
  
  fit_param <- paste(format(round(fit_param, digits = 2), nsmall = 2), fit_sign, sep = "")
  
  # Make a path diagram to visualize the results

  replic_figure <- semPaths(fit, what="std", # display the parameters on the arrows
                       nodeLabels = c("Self-Control", "Reappraisal", "Suppression", "Reduced\nPersonal Efficacy", "Need for Cognition"),
                       layout = matrix(data = c(0,0,0,1,-1,1,-0.3,-1,0.3,0.3), nrow = 5, ncol = 2), # manually set the node locations
                       sizeMan = 26, sizeMan2 = 8, shapeMan = "rectangle", label.scale = FALSE, # specify node properties
                       edgeLabels = fit_param, # specify the edge labels with the asterisks as previously created
                       edge.label.cex = 1, esize = 2, # size specifications
                       fade = FALSE, # do not make insignificant associations invisible
                       residuals = FALSE, # do not plot residuals
                       edge.label.color = "black", posCol = "black", negCol = "black"
)
```

`r replic_table`

```{r objective1years, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

  # Replication of Grass et al. (2018) using years spent teaching as a variable influencing self-control
  # (as indicated by the correlation of it with SCS but not with the other variables)
  
  repli_model_years <- '
  # direct paths
    scs       ~   a1 * ncs + y * years
    erq_reap  ~   a2 * ncs
    erq_supp  ~   a3 * ncs
    mbi_rpe   ~   b1 * scs + b2 * erq_reap + b3 * erq_supp + c * ncs
    
  # indirect effects
    Indirect1 := (a1 * b1) + (y * b1)
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3) + (y * b1)
'
  
  # Determine the model fit
  
  fityears <- sem(
    model = repli_model_years,
    data  = score_data,
    se = "bootstrap",
    bootstrap = 2000
  )
  
  # Get summary
  
  fityears_summ <- summary(fityears, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
```

Grass et al. [-@Grass2018] controlled for age and a-level grade in their analysis, which we did not consider when preregistering this analysis.
Since grade was not assessed in this sample, and age was assessed as a categorical variable, we instead incorporated how many years each participant had spent teaching at the point of assessment.
We placed this variable as an independent variable influencing self control, as the latter was the only variable in the model that showed a partial correlation with years spent teaching.
As it was not preregistered, this was an exploratory analysis.
Again, the baseline model did not fit the data ($\chi$^2^(`r round(fityears_summ$FIT[["baseline.df"]], digits = 0)`, $N=$ `r nrow(data)`) = `r round(fityears_summ$FIT[["baseline.chisq"]], digits = 2)`, $p < .001$), and the fit indices of $CFI=$ `r round(fityears_summ$FIT[["cfi"]], digits = 2)`, $TLI=$ `r round(fityears_summ$FIT[["tli"]], digits = 2)`, $SRMR=$ `r round(fityears_summ$FIT[["srmr"]], digits = 2)`, and $RMSEA=$ `r format(round(fityears_summ$FIT[["rmsea"]], digits = 2), nsmall = 2)`, 95% $CI$ [`r round(fityears_summ[["FIT"]][["rmsea.ci.lower"]], digits = 2)`,`r round(fityears_summ[["FIT"]][["rmsea.ci.upper"]], digits = 2)`], suggested good fit of the proposed model throughout all indices.
Standardized estimates, total, direct, and indirect effects are displayed and listed in *Supplementary Material S3*.
The associations between NFC, self control, reappraisal, suppression, and reduced personal efficacy were almost identical to the first model.
However, because of the positive association of years spent teaching and self control ($\beta=$ `r round(fityears_summ$PE$std.all[fityears_summ$PE$label == "y"], digits = 2)`, $p < .001$), the indirect path leading from NFC and years spent teaching via self control to reduced personal efficacy reached significance in this model ($\beta=$ `r round(fityears_summ$PE$std.all[fityears_summ$PE$label == "Indirect1"], digits = 2)`, $p=$ `r round(fityears_summ$PE$pvalue[fityears_summ$PE$label == "Indirect1"], digits = 3)`).
Therefore, the total effect also increased slightly, compared to the first model ($\beta=$ `r round(fityears_summ$PE$std.all[fityears_summ$PE$label == "Total"], digits = 2)`, $p=$ `r round(fityears_summ$PE$pvalue[fityears_summ$PE$label == "Total"], digits = 3)`).

```{r objective2, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

  # SEM with demand-resource-ratios
  
  sem_model <- '
  # measurement model
    NFC =~ nfc1 + nfc2 + nfc3 + nfc4
    DTH =~ dth1 + dth2 + dth3
    DTL =~ dtl1 + dtl2 + dtl3
    DRF =~ drf1 + drf2 + drf3
    MBI =~ mbi_ee + mbi_dp + mbi_rpe

  # structural model
    DTH ~ a1 * NFC
    DTL ~ a2 * NFC
    DRF ~ a3 * NFC
    MBI ~ c * NFC + b1 * DTH + b2 * DTL + b3 * DRF

  # indirect effects
    Indirect1 := a1 * b1
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3)'
  
  # Determine the model fit
  
  fit2 <- sem(
    model = sem_model,
    data  = score_data,
    estimator = "MLR"
  )
  
  # Get summary
  
  fit2_summ <- summary(fit2, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
  
```


```{r objective2table, echo=FALSE, message=FALSE, warning=FALSE}
  
  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  drr_table <- data.frame("Path" = c("NFC on DTH", "NFC on DTL", "NFC on DRF", "NFC on MBI",
                                      "DTH on MBI", "DTL on MBI", "DRF on MBI",
                                      "NFC on MBI via DTH", "NFC on MBI via DTL", "NFC on MBI via DRF",
                                      "Total Effect"),
                          "$B$" = c(fit2_summ$PE$est[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "$SE$" = c(fit2_summ$PE$se[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(fit2_summ$PE$z[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(fit2_summ$PE$pvalue[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(fit2_summ$PE$ci.lower[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(fit2_summ$PE$ci.upper[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(fit2_summ$PE$std.all[fit2_summ$PE$label != "" & fit2_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  drr_table[2:ncol(drr_table)] <- format(round(drr_table[2:ncol(drr_table)], digits = 3), nsmall = 2)

  drrmodel_table <-
    kbl(drr_table,
        caption = "Results of the demand-resource-ratio model.",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 7) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 8, 10) %>%
    pack_rows("Total Effect", 11, 11) %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand Resource Fit, MBI = Maslach Burnout Inventory, NFC = Need for Cognition, $SE$ = standard error.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
```

## Demand-Resource Model

Next we looked at how different ratios of subjective demands and resources affect the association of NFC and burnout.
The parcelling procedure for the indicators of the latent factor NFC resulted in four parcels with a summed difference in average loadings of `r round(ncs_parcels$summed.difference, digits = 3)`.
The first parcel contained item `r ncs_parcels$items[1,1]`, `r ncs_parcels$items[2,1]`, `r ncs_parcels$items[3,1]`, and `r ncs_parcels$items[4,1]`, the second parcel item `r ncs_parcels$items[1,2]`, `r ncs_parcels$items[2,2]`, `r ncs_parcels$items[3,2]`, and `r ncs_parcels$items[4,2]`, the third parcel item `r ncs_parcels$items[1,3]`, `r ncs_parcels$items[2,3]`, `r ncs_parcels$items[3,3]`, and `r ncs_parcels$items[4,3]`, and the fourth parcel item `r ncs_parcels$items[1,4]`, `r ncs_parcels$items[2,4]`, `r ncs_parcels$items[3,4]`, and `r ncs_parcels$items[4,4]`.
Standardized path coefficients of the demand-resource model are illustrated in Figure 2, total, direct, and indirect effects are listed in Table 4.
The robust Chi-square statistic of $\chi^2=$ `r round(fit2@test[["yuan.bentler.mplus"]]$stat, digits = 2)` ($p < .001$) did not indicate good model fit.
However, since it was in the range of `r round(fit2@test[["yuan.bentler.mplus"]]$stat/fit2@test[["yuan.bentler.mplus"]]$df, digits = 0)` $*df<\chi^2<$ `r round(fit2@test[["yuan.bentler.mplus"]]$stat/fit2@test[["yuan.bentler.mplus"]]$df, digits = 0)+1` $*df$ the lack of good fit might have been due to the underlying assumption of multivariate normality [@Hu1999; @Schumacker2012], which was violated here.
This also held true for the CFI of `r round(fit2_summ[["FIT"]][["cfi.robust"]], digits = 2)`, the SRMR of `r round(fit2_summ[["FIT"]][["srmr"]], digits = 2)`, and the RMSEA of `r round(fit2_summ[["FIT"]][["rmsea.robust"]], digits = 2)`, 95% $CI$ [`r round(fit2_summ[["FIT"]][["rmsea.ci.lower.robust"]], digits = 2)`,`r round(fit2_summ[["FIT"]][["rmsea.ci.upper.robust"]], digits = 2)`].
Overall, the fit indices did not support the proposed model, and not all proposed paths were significant.
NFC showed no direct association with the MBI score ($\beta=$ `r round(fit2_summ$PE$std.all[fit2_summ$PE$label == "c"], digits = 2)`, $p=$ `r round(fit2_summ$PE$pvalue[fit2_summ$PE$label == "c"], digits = 3)`), even though it was negatively correlated with the sum score and all subscales.
Instead, NFC showed indirect negative associations with the MBI score via lower scores in the latent variable DTH ($\beta=$ `r round(fit2_summ$PE$std.all[fit2_summ$PE$label == "Indirect1"], digits = 2)`, $p=$ `r round(fit2_summ$PE$pvalue[fit2_summ$PE$label == "Indirect1"], digits = 3)`) and via higher scores in the latent variable DRF ($\beta=$ `r round(fit2_summ$PE$std.all[fit2_summ$PE$label == "Indirect3"], digits = 2)`, $p=$ `r round(fit2_summ$PE$pvalue[fit2_summ$PE$label == "Indirect3"], digits = 3)`).
The latent variable DTL was neither related to NFC ($\beta=$ `r round(fit2_summ$PE$std.all[fit2_summ$PE$label == "a2"], digits = 2)`, $p=$ `r round(fit2_summ$PE$pvalue[fit2_summ$PE$label == "a2"], digits = 3)`) nor to the MBI score ($\beta=$ `r round(fit2_summ$PE$std.all[fit2_summ$PE$label == "b2"], digits = 2)`, $p=$ `r round(fit2_summ$PE$pvalue[fit2_summ$PE$label == "b2"], digits = 3)`).

```{r objective2plot, echo=FALSE, message=FALSE, warning=FALSE, fig.pos="H", fig.cap="Standardized path coefficients in the mediation of NFC and burnout by demand-resource-ratios. * $p<.05$, ** $p<.01$, *** $p<.001$. NFC = Need for Cognition, DTH = demands too high, DTL = demands too low, DRF = demand resource fit, MBI = Maslach Burnout Inventory, nfc1-4 = item parcels, dth/dtl/drf1-3 = item indicators, ee = emotional exhaustion, dp = depersonalisation, rpe = reduced personal efficacy."}

  # create an array of standardized parameters and an array of significances
  
  fit2_param <- fit2_summ$PE$std.all[1:23]
  fit2_sign <- c(rep(1,16), fit2_summ$PE$pvalue[17:23])

  # replace p-values with asterisks depending on significance level
  
  fit2_sign <- ifelse(fit2_sign < .001, "***", ifelse(fit2_sign < .01, "**", ifelse(fit2_sign < .05, "*", "")))
  
  # paste correlations and asterisks together
  
  fit2_param <- paste(format(round(fit2_param, digits = 2), nsmall = 2), fit2_sign, sep = "")  

  # Visualize the results
  
  drr_figure <- semPaths(fit2, what = "std",
                        nodeLabels = c("nfc1","nfc2","nfc3","nfc4","dth1","dth2","dth3","dtl1","dtl2","dtl3","drf1","drf2","drf3","ee","dp","rpe","NFC","DTH","DTL","DRF","MBI"),
                        layout = matrix(data = c(-1,-0.8,-0.6,-0.4,-0.8,-0.6,-0.4,-0.2,0,0.2,0.4,0.6,0.8,0.6,0.8,1,-0.8,-0.6,0,0.6,0.8,
                                                 -1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-0.5,0.5,0.5,0.5,-0.5),
                                        nrow = 21, ncol = 2),
                        residuals = FALSE, fade = FALSE,
                        edgeLabels = fit2_param, # specify the edge labels with the asterisks as previously created
                        edge.label.cex = 1, esize = 2, # size of the parameters
                        edge.label.position = c(0.6,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,0.5,0.55,0.4,0.5,0.6,0.45,0.5),
                        edge.label.color = "black", edge.label.bg = TRUE, # color and background of the parameters
                        posCol = "black", negCol = "black" # color of arrows
  )
```

`r drrmodel_table`

```{r exploringbadfit, echo=FALSE, message=FALSE, warning=FALSE}

  # Use function from http://www.sthda.com/english/wiki/correlation-matrix-a-
  # quick-start-guide-to-analyze-format-and-visualize-a-correlation-matrix-
  # using-r-software#a-simple-function-to-format-the-correlation-matrix
  # accessed on September 23rd 2021

  flattenCorrMatrix <- function(cormat, pmat) {
    ut <- upper.tri(cormat)
    data.frame(
      row = rownames(cormat)[row(cormat)[ut]],
      column = rownames(cormat)[col(cormat)[ut]],
      cor  =(cormat)[ut],
      p = pmat[ut]
      )
  }

  # Compute data frame of partial correlations

  partialcorr <- flattenCorrMatrix(pcor(score_data[c("years","mbi","mbi_ee","mbi_dp","mbi_rpe",
                                                     "erq","erq_supp","erq_reap","scs","ncs",
                                                     "dth","dtl","drf","covb")], method = "spearman")$estimate,
                                  pcor(score_data[c("years","mbi","mbi_ee","mbi_dp","mbi_rpe",
                                                    "erq","erq_supp","erq_reap","scs","ncs",
                                                    "dth","dtl","drf","covb")], method = "spearman")$p.value)
  # Add easy-to-read significance column
  
  partialcorr$sign <- ifelse(partialcorr$p < 0.05, "sign", "ns")

```

```{r exploratory1, echo=FALSE, message=FALSE, warning=FALSE, results="hide"}

  # Exploratory analysis I: MBI subscale instead of sum score
  
  explor1_model <- '
  # measurement model
    NFC =~ nfc1 + nfc2 + nfc3 + nfc4
    DTH =~ dth1 + dth2 + dth3
    DTL =~ dtl1 + dtl2 + dtl3
    DRF =~ drf1 + drf2 + drf3
    RPE =~ mbi_rpe

  # structural model
    DTH ~ a1 * NFC
    DTL ~ a2 * NFC
    DRF ~ a3 * NFC
    RPE ~ c * NFC + b1 * DTH + b2 * DTL + b3 * DRF

  # indirect effects
    Indirect1 := a1 * b1
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3)'
  
  # Determine the model fit
  
  fit_explor1 <- sem(
    model = explor1_model,
    data  = score_data,
    estimator = "MLR"
  )
  
  # Get summary
  
  fit_explor1_summ <- summary(fit_explor1, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
```

```{r exploratory1table, echo=FALSE, message=FALSE, warning=FALSE}
  
  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  drr_rpe_table <- data.frame("Path" = c("NFC on DTH", "NFC on DTL", "NFC on DRF", "NFC on RPE",
                                      "DTH on RPE", "DTL on RPE", "DRF on RPE",
                                      "NFC on RPE via DTH", "NFC on RPE via DTL", "NFC on RPE via DRF",
                                      "Total Effect"),
                          "$B$" = c(fit_explor1_summ$PE$est[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "$SE$" = c(fit_explor1_summ$PE$se[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(fit_explor1_summ$PE$z[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(fit_explor1_summ$PE$ci.lower[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(fit_explor1_summ$PE$ci.upper[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label != "" & fit_explor1_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  drr_rpe_table[2:ncol(drr_rpe_table)] <- format(round(drr_rpe_table[2:ncol(drr_rpe_table)], digits = 3), nsmall = 2)

  drr_rpe_table <-
    kbl(drr_rpe_table,
        caption = "Results of the demand-resource-ratio model with reduced personal efficacy in place of the MBI score.",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 7) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 8, 10) %>%
    pack_rows("Total Effect", 11, 11) %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand Resource Fit, RPE = Reduced Personal Efficacy subscale of the Maslach Burnout Inventory, NFC = Need for Cognition, $SE$ = standard error.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
```

## Exploratory analyses

The first exploratory analysis concerned a modification of the demand-resource-model in which the subscale reduced personal efficacy would be used in place of the MBI sum score.
Path coefficients, total, direct, and indirect effects are displayed and listed in *Supplementary Material S4*.
Similar to the previous model, this model's indices did not indicate good fit, with a Chi-square statistic of $\chi^2=$ `r round(fit_explor1@test[["yuan.bentler.mplus"]]$stat, digits = 2)` ($p < .001$), a CFI of `r round(fit_explor1_summ[["FIT"]][["cfi.robust"]], digits = 2)`, a SRMR of `r round(fit_explor1_summ[["FIT"]][["srmr"]], digits = 2)`, and a RMSEA of `r round(fit_explor1_summ[["FIT"]][["rmsea.robust"]], digits = 2)`, 95% $CI$ [`r round(fit_explor1_summ[["FIT"]][["rmsea.ci.lower.robust"]], digits = 2)`,`r round(fit_explor1_summ[["FIT"]][["rmsea.ci.upper.robust"]], digits = 2)`].
NFC showed no direct association with reduced personal efficacy ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "c"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "c"], digits = 3)`), but an indirect one via higher scores in the latent variable DRF ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "Indirect3"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "Indirect3"], digits = 3)`).
And again, NFC was associated with lower scores in the latent variable DTH ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "a1"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "a1"], digits = 3)`), but the latter did not mediate the relationship between NFC and reduced personal efficacy ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "Indirect1"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "Indirect1"], digits = 3)`) as it did with the MBI score in the previous model.
The latent variable DTL was neither related to NFC ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "a2"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "a2"], digits = 3)`) nor to the MBI score ($\beta=$ `r round(fit_explor1_summ$PE$std.all[fit_explor1_summ$PE$label == "b2"], digits = 2)`, $p=$ `r round(fit_explor1_summ$PE$pvalue[fit_explor1_summ$PE$label == "b2"], digits = 3)`).

```{r exploratory2, echo=FALSE, message=FALSE, warning=FALSE, results="hide"}

  # Exploratory analysis II: Covid burden as a covariate
  
  explor2_model <- '
  # measurement model
    NFC =~ nfc1 + nfc2 + nfc3 + nfc4
    DTH =~ dth1 + dth2 + dth3
    DRF =~ drf1 + drf2 + drf3

  # structural model
    covb ~ yc * years
    scs ~ ys * years
    NFC ~~ scs
    NFC ~~ covb
    DTH ~ cdth * covb + sdth * scs + ndth* NFC
    DRF ~ sdrf * scs + ndrf * NFC
    DTH ~~ DRF
    mbi_ee ~ dthe * DTH + ce * covb
    mbi_rpe ~ drfr * DRF
    
    mbi_ee ~~ mbi_rpe
    NFC ~~ years

    dth1 ~~ dth2
    dth1 ~~ dth3
    dth2 ~~ dth3

    drf1 ~~ drf2
    drf1 ~~ drf3
    drf2 ~~ drf3
    
  # Indirect effects
    Indirect1 := (ndrf * drfr) + (ys * sdrf * drfr)
    Indirect2 := (ndth * dthe) + (ys * sdth * dthe) + (yc * cdth * dthe)

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2
         
  # total effect
    Total := (ndrf * drfr) + (ys * sdrf * drfr) + (ndth * dthe) + (ys * sdth * dthe) + (yc * cdth * dthe)
'
  
  # Determine the model fit
  
  fit_explor2 <- sem(
    model = explor2_model,
    data  = score_data,
    estimator = "MLR"
  )
  
  # Get summary
  
  fit_explor2_summ <- summary(fit_explor2, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
```

The second exploratory analysis concerned the incorporation of the Covid burden score into the model.
We based the development of this model on the partial correlations of all variables, which provide an indication of how closely or remotely related variables might be in a path model.
Then we modified the structure of the model using the *modincides()*-function in *lavaan* in order to increase the goodness-of-fit indices within the framework of contentually meaningful variable relationships.
The final model is illustrated in Figure 3, the total, direct, and indirect effects are listed in *Supplementary Material S5*.
All fit indices suggested that the proposed model had good fit while the baseline model did not ($\chi^2=$ `r round(fit_explor2@test[["yuan.bentler.mplus"]]$stat, digits = 2)` ($p < .001$), $CFI=$ `r round(fit_explor2_summ[["FIT"]][["cfi.robust"]], digits = 2)`, $RMSEA=$ `r round(fit_explor2_summ[["FIT"]][["rmsea.robust"]], digits = 2)` (95% $CI$ [`r round(fit_explor2_summ[["FIT"]][["rmsea.ci.lower.robust"]], digits = 2)`,`r round(fit_explor2_summ[["FIT"]][["rmsea.ci.upper.robust"]], digits = 2)`]), $SRMR=$ `r round(fit_explor2_summ[["FIT"]][["srmr"]], digits = 2)`).
Neither the ERQ sum score, nor its subscales, nor the depersonalisation subscale of the MBI contributed significantly to the explained variance and were therefore not included in the final model.
Years spent teaching was associated with higher self control ($\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "ys"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "ys"], digits = 3)`) and higher Covid burden ($\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "yc"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "yc"], digits = 3)`) but not with NFC.
NFC covaried with self control ($\sigma_{NFC,scs}=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$lhs == "NFC" & fit_explor2_summ$PE$op == "~~" & fit_explor2_summ$PE$rhs == "scs"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$lhs == "NFC" & fit_explor2_summ$PE$op == "~~" & fit_explor2_summ$PE$rhs == "scs"], digits = 3)`) and Covid burden ($\sigma_{NFC,covb}=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$lhs == "NFC" & fit_explor2_summ$PE$op == "~~" & fit_explor2_summ$PE$rhs == "covb"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$lhs == "NFC" & fit_explor2_summ$PE$op == "~~" & fit_explor2_summ$PE$rhs == "covb"], digits = 3)`), but not with years spent teaching ($p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$lhs == "NFC" & fit_explor2_summ$PE$op == "~~" & fit_explor2_summ$PE$rhs == "years"], digits = 3)`).
In turn, NFC was associated with higher DRF scores ($\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "ndrf"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "ndrf"], digits = 3)`) and lower DTH scores ($\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "ndth"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "ndth"], digits = 3)`) but not directly with any of the two MBI subscales.
DRF scores fully mediated the negative association of NFC and self control with reduced personal efficacy (indirect effect $\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "Indirect1"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "Indirect1"], digits = 3)`), which was also true for DTH scores and emotional exhaustion, but DTH also partially mediated between Covid burden and emotional exhaustion (indirect effect $\beta=$ `r round(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label == "Indirect2"], digits = 2)`, $p=$ `r round(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label == "Indirect2"], digits = 3)`).
Covid burden was not associated with DRF or reduced personal efficacy.

```{r explor2plot, echo=FALSE, message=FALSE, warning=FALSE, fig.pos="H", fig.cap="Standardized path coefficients in the exploratory analysis of variable relations. * $p<.05$, ** $p<.01$, *** $p<.001$. Years = years spent teaching, SCS = Self-Control Scale, COVB = Covid burden, NFC = Need for Cognition, DTH = demands too high, DRF = demand resource fit, nfc1-4 = item parcels, dth/drf1-3 = item indicators, EE = emotional exhaustion, RPE = reduced personal efficacy."}

  # create an array of standardized parameters and an array of significances
  
  fit_explor2_param <- fit_explor2_summ$PE$std.all[c(1:25)]
  fit_explor2_sign <- c(rep(1,10), fit_explor2_summ$PE$pvalue[11:25])

  # replace p-values with asterisks depending on significance level
  
  fit_explor2_sign <- ifelse(fit_explor2_sign < .001, "***", ifelse(fit_explor2_sign < .01, "**", ifelse(fit_explor2_sign < .05, "*", "")))
  
  # paste correlations and asterisks together
  
  fit_explor2_param <- paste(format(round(fit_explor2_param, digits = 2), nsmall = 2), fit_explor2_sign, sep = "")  

  # Visualize the results
  
  explor2_fig <- semPaths(fit_explor2, what = "std",
                               nodeLabels = c("nfc1","nfc2","nfc3","nfc4",
                                              "COVB", "SCS",
                                              "dth1","dth2","dth3",
                                              "EE",
                                              "drf1","drf2","drf3",
                                              "RPE",
                                              "YEARS",
                                              "NFC",
                                              "DTH","DRF"),
                        layout = matrix(data = c(-0.6,-0.4,-0.2,0,
                                                 -0.2,-0.5,
                                                 0.3,0.5,0.7,
                                                 1,
                                                 0.3,0.5,0.7,
                                                 1,
                                                 -1,
                                                 -0.2,
                                                 0.5,0.5,
                                                 1,1,1,1,
                                                 -0.4,0.1,
                                                 -1,-1,-1,
                                                 0,
                                                 1,1,1,
                                                 0.5,
                                                 0.1,
                                                 0.5,
                                                 -0.5,0.5),
                                        nrow = 18, ncol = 2),
                        residuals = FALSE, fade = FALSE,
                        edgeLabels = fit_explor2_param, # specify the edge labels with the asterisks as previously created
                        edge.label.cex = 1, esize = 2, # size of the parameters
                        edge.label.position = c(0.6,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,rep(0.5,32)),
                        edge.label.color = "black", edge.label.bg = TRUE, # color and background of the parameters
                        posCol = "black", negCol = "black" # color of arrows
  )
```

# Discussion

The present study aimed to replicate findings of mediators between Need for Cognition and burnout in teachers, as well as to extend the analysis to the role of different ratios of demands and resources in burnout using latent variable models.
In an exploratory approach, we investigated the influence of the burden that the Covid-19 pandemic has placed on teachers.
Previous studies have indicated a protective effect of NFC against burnout, but the associations with the burnout subscales were inconsistent, suggesting that there are more variables influencing this relationship.

## Replication of Grass et al. (2018)

While the mediation model had good fit, not all patterns were similar to the original study: NFC and self-control were positively associated, and reappraisal and reduced personal efficacy were negatively related, but there was no association between NFC and reappraisal.
There was, however, a positive association between self-control and reduced personal efficacy, and a negative one between NFC and suppression.

NFC had a direct and negative effect on reduced personal efficacy, but this relationship was not mediated by any other variable.
Only when the amount of teaching experience was included as a predictor of self-control next to NFC, an indirect effect via self-control reached significance, indicating that teachers with high NFC and more years of teaching experience have higher self-control and, consequently, lower reduced personal efficacy.
The higher self-control that comes with more teaching experience is in line with findings of fluctuations in self-control in young adults, reaching a low point between the age of 15 and 19 [@Oliva2019].
The participants in the study by Grass et al. [-@Grass2018] were teacher trainees with a mean age of 25.5 years, while the majority of the current sample was between 40 and 59 years old.
Therefore, it is likely that not only the teaching experience itself but also higher age might be associated with higher self-control.
However, one could argue that more experience provides the teacher with a bigger repertoire of coping strategies to enable an efficient exertion of self-control, especially for teachers high in NFC who are intrinsically motivated to find and apply such strategies.

We could replicate the relation between the two emotion regulation strategies reappraisal and suppression with reduced personal efficacy, but not their association with NFC.
There is ample evidence that reappraisal is associated with positive outcomes for students [@Levine2012;@Schmidt2010;@Haga2007] and teachers alike [@Moe2020;@Tsouloupas2010;@Jiang2016], so it is suprising that reappraisal did not mediate between NFC and reduced personal efficacy.
Reappraisal did correlate with NFC, as it should appease the preference for cognitive effort in individuals with high NFC, but it was not a mediator in this model.
One possible explanation could be that the ways by which reappraisal can be achieved, such as taking the role of an uninvolved observer, are less feasible for teachers in retaining their sense of efficacy in the classroom than the self-control needed to structurally manage students and situations.
Hence, the mediation of NFC and reduced personal efficacy by self-control when taking the years spent teaching into account.

## Demand-resource-ratio model

Despite not having good fit indices, the model suggested a complete mediation of NFC and burnout via DTH and DRF but not DTL.
Specifically, individuals with higher NFC had lower burnout scores through perceiving demands as fitting to and not exceeding their own resources.
Interestingly, the correlation between NFC and burnout, which can be classified as medium according to Gignac and Szodorai [-@Gignac2016], disappeared in the context of the demand-resource-ratios as mediators.
The mediator that did not reach significance was the perception of own resources exceeding the job demands.
As this latent variable was conceptualized as boredom at work, we could not confirm the positive association of boredom and burnout found by Reijseger et al. [-@Reijseger2013.].
The fact that the items that made up the demand-resource-ratios were about the subjective perception and not about objective measures, supports the idea that the individual appraisal of one's own circumstances plays a crucial role in the development of burnout.
This individual appraisal has been emphasized as the cause for the ambiguous impact of demands on psychological well-being before, in the form of challenge demands and hindrance demands [@Lepine2005;@Podsakoff2007;@Lazarus1984].
Challenge demands such as time pressure, responsibility, and workload [@Podsakoff2007] are being positively valued due to their potential to increase personal growth, positive affect, and problem-focused coping [@Lepine2005].
In contrast, hindrance demands such as inadequate resources, role conflict, and organisational politics [@Podsakoff2007] are perceived as negative because they harm personal growth, trigger negative emotions, and increase passive coping [@Lepine2005].
Ventura et al. [-@Ventura2015] found that hindrance but not challenge demands were positively related to burnout in teachers, and teachers who reported high challenge and low hindrance demands also reported higher engagement.
Whether and to what extent a circumstance is perceived as a challenge or hindrance demand is highly influenced by a person's level of self-efficacy [@Bandura1997], so much so that a reduction in self-efficacy is considered to be a precurser of burnout, not necessarily a symptom [@Cherniss1993;@Vera2012].
Self-efficacy and self-control are closely entwined [@Przepiorka2019;@Vera2004;@Yang2019] and both are positively associated with NFC [@Xu2021;@Bertrams2012;@Naderi2018;@Holch2020].
Cacioppo et al. [-@Cacioppo1996] even proposed that higher levels of NFC might develop as a result of a high need for structure or control in those who have the skill, ability, and inclination to do so.
These associations would imply that teachers with high levels of NFC report lower levels of burnout because their higher (desire for) self-control motivates them to appraise demands as a chance for personal growth, thereby meeting their passion for thinking and problem-solving.
Nevertheless, appraisal is no universal remedy for circumstances that threaten well-being, as there certainly are circumstances that one cannot get any benefit out of.
It remains an open question whether a high desire for control and high NFC might cloud one's judgement in this case, by encouraging to invest one's own insufficient resources in order to meet these high external demands.
Such behavioural tendencies would threaten personal well-being in the long term, as the demands cannot be met, self-efficacy declines, and stress increases.

## Exploratory analyses
### Demand-resource-ratio model with subscale

The demand-resource-ratio model with the subscale reduced personal efficacy in place of the MBI score did not have good fit indices.
Compared to the confirmatory demand-resource-ratio model, the mediation of NFC and reduced personal efficacy via DTH did not reach significance, but both the mediation via DRF and the total effect remained significant.
Overall, this pattern did not resemble those from previous studies in which NFC had the strongest relation with this subscale of the MBI [@Grass2018;@Naderi2018].
Teachers with high NFC appear to retain their sense of personal efficacy to a higher degree, because they experience a fit of demands and resources, which allows them to complete tasks and reinforce their self-efficacy in return.
However, while this association was similar in the confirmatory and the exploratory demand-resource-ratio model, the mediation via DTH was not significant with this subscale, suggesting that the large association of DTH and MBI in the confirmatory model was driven by a different subscale.
To explore this, we built a second exploratory model.

### Exploratory model with Covid burden

Due to the complete freedom in setting up the structure of this model, it had good fit indices.
Interestingly, the third MBI subscale depersonalisation and the latent variable DTL did not explain any variance in the model, so they were removed.
Once again, NFC and self-control were positively related, but NFC was also positively related to Covid burden.
One possible explanation is that teachers with higher NFC show higher consideration of the consequences and progression of the pandemic, thereby anticipating that it will take a long time until normal teaching can resume, which heightens their feeling of being burdened.
Although NFC has been shown to be related to more reflective thinking and unrelated to rumination, which are considered healthy and unhealthy thinking styles, respectively [@Vannucci2018;@Nishiguchi2018], a higher perceived Covid burden itself cannot indicate whether it stems from a realistic view on the pandemic or a feeling of being overwhelmed.
Teachers with more years of experience also reported higher Covid burden, presumably because older people are less comfortable with technology [@Hauk2018] and therefore stressed by the prospect of online teaching.
Teachers with higher self-control and higher NFC reported a stronger fit of demands and resources, which was associated with a strong decrease in reduced personal efficacy.
Higher self-control, higher NFC, and lower Covid burden was in turn associated with a lower DTH score, so teachers with those characteristics felt less overwhelmed and consequently less emotionally exhausted.
The degree of association between DTH and emotional exhaustion indeed suggested a congruence between the two, indicating that emotional exhaustion in burnout is caused by excessive demands that cannot be met with one's resources, while reduced personal efficacy in burnout is caused by a lack of opportunities to utilize one's resources at work.
Curiously, higher Covid burden also showed a small negative association with emotional exhaustion.
It could be that for some teachers, remote teaching was experienced as a relief from the strain of dealing with a group of over twenty students each day, who are more likely to misbehave in a classroom setting than when they are studying at home.
So while those teachers did feel the pandemic burden, they also felt less emotionally exhausted.

## Limitations and future implications

The data used in this study had been collected for another purpose, so there were several aspects that would have improved the investigation of our research questions but were not feasible.
Firstly, collecting coping style data would have enabled a full replication of the mediation model of Grass et al. [-@Grass2018].
Secondly, longitudinal data would have facilitated more definitive conclusions about causal relations, as well as about inter-individual differences in the perception of demands and resources as the pandemic progresses.
Furthermore, the latent variables for the demand-resource-ratios were item groups chosen from the work satisfaction questionnaire and had not been validated for this use before.
However, as two of them showed meaningful relations with self-control, NFC, and two of the three MBI subscales, pursuing this concept further seems promising.
Especially because we worked with pre-existing data, we preregistered all analyses and clearly differentiated between confirmatory and exploratory models in order to make the results as reliable as possible.
Applied to real-life teaching practise, our results suggest that a healthy work environment should offer ample opportunities to make use of one's abilities, without creating demands that are too high.
As a consequence, experiences and sense of self-efficacy will increase, which in turn heightens confidence in one's skills to deal with future demands that are higher, preventing loss of personal efficacy and burnout in the long term.


\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup

\newpage

# Supplementary Material

## S1: Items used to assess Covid burden

1. How burdened do you currently feel by the measures associated with Covid-19?

2. Are you in a Covid-19 risk group?

3. Do you have or have you had a Covid-19 infection?

4. Are or were family members or other people close to you infected with Covid-19?

5. Do you feel more burdened at work?

6. Are your worried more?

7. Do you feel restricted in your current day-to-day life?

8. Do you currently have additional responsibilities?

9. How much time do you currently spend on leisure activities?

10. Do you currently spend more/less time on work-related activities (e.g. preparing lessons, reading literature, attending trainings for digital teaching)?

11. Did the current demands within your job change?

For each response scale, please refer to Excel file with the full list of items and response types on OSF [https://osf.io/36ep9/](https://osf.io/36ep9/).

\newpage
\counterwithin{figure}{section}
\counterwithin{table}{section}
\setcounter{section}{19}
\setcounter{figure}{0}
\setcounter{table}{0}

## S2: Results when excluding the outlier with very high MBI scores and very low NFC scores

```{r outlierconsistency, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}

  # Tests for internal consistency

    # Create data frame to feed values into

    outlierconsistencies <- data.frame(value = c("lower CI alpha","raw alpha","upper CI alpha",
                                          "lower CI omega","raw omega","upper CI omega"))

    # Compute Cronbach's Alpha and MacDonald's Omega for questionnaires and demand-resource-ratios

    set.seed(13) # seed for reproducing the bootstrapping
    
    # Maslach Burnout Inventory
    
    cronalph <- alpha(mbi, check.keys = TRUE)
    macomega <- ci.reliability(data=mbi[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$mbi <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI emotional exhaustion
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_ee), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi[-161,], select = keylist$mbi_ee), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$mbi_ee <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI depersonalization
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_dp), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi[-161,], select = keylist$mbi_dp), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$mbi_dp <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # MBI reduced personal efficacy
    
    cronalph <- alpha(subset(mbi, select = keylist$mbi_rpe), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(mbi[-161,], select = keylist$mbi_rpe), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$mbi_rpe <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                 cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                 macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ
    
    cronalph <- alpha(erq, check.keys = TRUE)
    macomega <- ci.reliability(data=erq[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$erq <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ suppression
    
    cronalph <- alpha(subset(erq, select = keylist$erq_supp), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(erq[-161,], select = keylist$erq_supp), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$erq_supp <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # ERQ reappraisal
    
    cronalph <- alpha(subset(erq, select = keylist$erq_reap), check.keys = TRUE)
    macomega <- ci.reliability(data=subset(erq[-161,], select = keylist$erq_reap), type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$erq_reap <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                                  cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                                  macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Self Control Scale
    
    cronalph <- alpha(scs, check.keys = TRUE)
    macomega <- ci.reliability(data=scs[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$scs <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Need for Cognition Scale
    
    cronalph <- alpha(ncs, check.keys = TRUE)
    macomega <- ci.reliability(data=ncs[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$ncs <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Covid burden
    
    cronalph <- alpha(covb, check.keys = TRUE)
    macomega <- ci.reliability(data=covb[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$covb <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demands Too High
    
    cronalph <- alpha(dth, check.keys = FALSE)
    macomega <- ci.reliability(data=dth[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$dth <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demands Too Low
    
    cronalph <- alpha(dtl, check.keys = FALSE)
    macomega <- ci.reliability(data=dtl[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$dtl <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    # Demand Resource Fit
    
    cronalph <- alpha(drf, check.keys = FALSE)
    macomega <- ci.reliability(data=drf[-161,], type="omega", conf.level = 0.95, interval.type="bca", B=bootnum)
    outlierconsistencies$drf <- round(c(cronalph$total$raw_alpha - 1.96 * cronalph$total$ase, cronalph$total$raw_alpha,
                             cronalph$total$raw_alpha + 1.96 * cronalph$total$ase,
                             macomega$ci.lower, macomega$est, macomega$ci.upper), digits = 2)
    
    remove(cronalph,macomega) # delete the temporary variable
    
```

```{r outliercorrelations, echo=FALSE, message=FALSE, warning=FALSE}
    
    # correlate variables
    outliercorrelations <- correlation_matrix(score_data_no_outlier[c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap",
                                                    "scs","ncs","dth","dtl","drf","covb")],
                                       type = "spearman",
                                       use = "lower",
                                       show_significance = FALSE,
                                       replace_diagonal = TRUE,
                                       replacement = "")
    
    # reorder the columns of the consistencies data frame to match the correlation columns
    outlierconsist_diag <- outlierconsistencies[c(colnames(outliercorrelations))]
    
    # create a vector of consistencies to be used as the diagonal in a table later
    outlierconsist_diag <- cbind(format(round(t(outlierconsist_diag[2,]), digits = 2), nsmall = 2), rep("(",10),
                          format(round(t(outlierconsist_diag[5,]), digits = 2), nsmall = 2), rep(")",10))
    
    # paste together to create the output "alpha(omega)"
    outlierconsist_diag <- apply(outlierconsist_diag[,c(1:4)], 1 ,paste, collapse = "")
    
    # add previously assembled diagonal with alpha and omega values
    diag(outliercorrelations) <- outlierconsist_diag
    
    # set row and column names for better table printing
    row.names(outliercorrelations) <- c("1. MBI","2. MBI EE","3. MBI DP","4. MBI RPE","5. ERQ","6. ERQ S","7. ERQ R",
                                 "8. SCS","9. NFC","10. DTH","11. DTL","12. DRF","13. COV")
    colnames(outliercorrelations) <- c("1","2","3","4","5","6","7","8","9","10","11","12","13")
    
    # create array with p-values of correlation coefficients
    outliercorr_pvalues <- rcorr(as.matrix(score_data_no_outlier[c("mbi","mbi_ee","mbi_dp","mbi_rpe","erq","erq_supp","erq_reap",
                                                 "scs","ncs","dth","dtl","drf","covb")]), type = "spearman")$P
    # replace upper triangle with NA
    outliercorr_pvalues[upper.tri(outliercorr_pvalues, diag = TRUE)] <- NA
    
    # replace p-values with asterisks depending on significance level
    outliercorr_pvalues <- ifelse(is.na(outliercorr_pvalues), "",
                                  ifelse(outliercorr_pvalues < .001, "***", ifelse(outliercorr_pvalues < .01, "**", ifelse(outliercorr_pvalues < .05, "*", ""))))
    
    # convert to matrix for the paste()-function
    outliercorrelations <- as.matrix(outliercorrelations)
    outliercorr_pvalues <- as.matrix(outliercorr_pvalues)
    
    # paste correlations and asterisks together
    outliercorrelations <- matrix(paste(outliercorrelations, outliercorr_pvalues, sep = ""),
                           nrow = nrow(outliercorrelations), dimnames = dimnames(outliercorrelations))
    
```

```{r outliercorrelationstable, echo=FALSE, message=FALSE, warning=FALSE, caption="Correlations and internal consistencies"}

  outliercorr_table <-
  kbl(outliercorrelations,
      caption = "Spearman correlations and internal consistencies of the questionnaire scores.",
      booktabs = TRUE, # no vertical lines
      escape = FALSE, # correctly print special characters
      align = rep("l",14)) %>% # left aligns the text in every column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    footnote(general = "MBI = Maslach Burnout Inventory, MBI EE = Emotional exhaustion subscale, MBI DP = Depersonalisation subscale, MBI RPE = Reduced personal efficacy subscale, ERQ = Emotion Regulation Questionnaire, ERQ S = Suppression subscale, ERQ R = Reappraisal subscale, SCS = Self-Control Scale, NFC = Need for Cognition, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand-Resource-Fit, COV = Covid-19 Burden. \\\\textit{N} = 179. * \\\\textit{p} < .05. ** \\\\textit{p} < .01. *** \\\\textit{p} < .001. Diagonal is Cronbach's Alpha and (in brackets) MacDonald's Omega.",
             escape = FALSE, # correctly print special characters
             threeparttable = TRUE) %>% # line breaks in the footnote
  kableExtra::landscape() # make the table horizontal 

```

`r outliercorr_table`

```{r outlierobjective1, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

  # Replication of Grass et al. (2018)
  
  outlierrepli_model <- '
  # direct paths
    scs       ~   a1 * ncs
    erq_reap  ~   a2 * ncs
    erq_supp  ~   a3 * ncs
    mbi_rpe   ~   b1 * scs + b2 * erq_reap + b3 * erq_supp + c * ncs
    
  # indirect effects
    Indirect1 := a1 * b1
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3)
'
  
  # Determine the model fit
  
  outlierfit <- sem(
    model = outlierrepli_model,
    data  = score_data_no_outlier,
    se = "bootstrap",
    bootstrap = 2000
  )
  
  # Get summary
  
  outlierfit_summ <- summary(outlierfit, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
```

```{r outlierobjective1table, echo=FALSE, message=FALSE, warning=FALSE, caption="Results of the replication of Grass et al. (2018)"}

  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  outlierreplic_table <- data.frame("Path" = c("NFC on Self Control", "NFC on Reappraisal", "NFC on Suppression",
                                   "Self Control on RPE", "Reappraisal on RPE", "Suppression on RPE", "NFC on RPE",
                                   "NFC on RPE via Self Control", "NFC on RPE via Reappraisal", "NFC on RPE via Suppression",
                                   "Total Effect"),
                          "$B$" = c(outlierfit_summ$PE$est[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "$SE$" = c(outlierfit_summ$PE$se[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(outlierfit_summ$PE$z[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(outlierfit_summ$PE$pvalue[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(outlierfit_summ$PE$ci.lower[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(outlierfit_summ$PE$ci.upper[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(outlierfit_summ$PE$std.all[outlierfit_summ$PE$label != "" & outlierfit_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  outlierreplic_table[2:ncol(outlierreplic_table)] <- format(round(outlierreplic_table[2:ncol(outlierreplic_table)], digits = 3), nsmall = 2)

  outlierreplic_table <-
    kbl(outlierreplic_table,
        caption = "Results of the replication of Grass et al. (2018).",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 7) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 8, 10) %>%
    pack_rows("Total Effect", 11, 11) %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, NFC = Need for Cognition, RPE = reduced personal efficacy subscale of the Maslach Burnout Inventory, $SE$ = standard error, $N=179$.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
  
```

`r outlierreplic_table`

```{r outlierobjective2, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

  # SEM with demand-resource-ratios
  
  outliersem_model <- '
  # measurement model
    NFC =~ nfc1 + nfc2 + nfc3 + nfc4
    DTH =~ dth1 + dth2 + dth3
    DTL =~ dtl1 + dtl2 + dtl3
    DRF =~ drf1 + drf2 + drf3
    MBI =~ mbi_ee + mbi_dp + mbi_rpe

  # structural model
    DTH ~ a1 * NFC
    DTL ~ a2 * NFC
    DRF ~ a3 * NFC
    MBI ~ c * NFC + b1 * DTH + b2 * DTL + b3 * DRF

  # indirect effects
    Indirect1 := a1 * b1
    Indirect2 := a2 * b2
    Indirect3 := a3 * b3

  # contrast (if significant, the effects differ)
    Contrast := Indirect1 - Indirect2 - Indirect3
         
  # total effect
    Total := c + (a1 * b1) + (a2 * b2) + (a3 * b3)'
  
  # Determine the model fit
  
  outlierfit2 <- sem(
    model = outliersem_model,
    data  = score_data_no_outlier,
    estimator = "MLR"
  )
  
  # Get summary
  
  outlierfit2_summ <- summary(outlierfit2, fit.measures = TRUE, standardize = TRUE, rsquare = TRUE,
          estimates = TRUE, ci = TRUE)
  
```

```{r outlierobjective2table, echo=FALSE, message=FALSE, warning=FALSE}
  
  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  outlierdrr_table <- data.frame("Path" = c("NFC on DTH", "NFC on DTL", "NFC on DRF", "NFC on MBI",
                                      "DTH on MBI", "DTL on MBI", "DRF on MBI",
                                      "NFC on MBI via DTH", "NFC on MBI via DTL", "NFC on MBI via DRF",
                                      "Total Effect"),
                          "$B$" = c(outlierfit2_summ$PE$est[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "$SE$" = c(outlierfit2_summ$PE$se[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(outlierfit2_summ$PE$z[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(outlierfit2_summ$PE$pvalue[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(outlierfit2_summ$PE$ci.lower[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(outlierfit2_summ$PE$ci.upper[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(outlierfit2_summ$PE$std.all[outlierfit2_summ$PE$label != "" & outlierfit2_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  outlierdrr_table[2:ncol(outlierdrr_table)] <- format(round(outlierdrr_table[2:ncol(outlierdrr_table)], digits = 3), nsmall = 2)

  outlierdrrmodel_table <-
    kbl(outlierdrr_table,
        caption = "Results of the demand-resource-ratio model.",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 7) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 8, 10) %>%
    pack_rows("Total Effect", 11, 11) %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, DTH = Demands Too High, DTL = Demands Too Low, DRF = Demand Resource Fit, MBI = Maslach Burnout Inventory, NFC = Need for Cognition, $SE$ = standard error, $N=179$.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
```

`r outlierdrrmodel_table`

\newpage

## S3: Replication of Grass et al. (2018) when including years spent teaching

```{r objective1yearsplot, echo=FALSE, message=FALSE, warning=FALSE, fig.pos="H", fig.cap="Standardized regression coefficients in the replication of Grass et al. (2018) when including years spent teaching. * $p<.05$, ** $p<.01$."}

  # create an array of standardized parameters and an array of significances
  
  fityears_param <- fityears_summ$PE$std.all[1:8]
  fityears_sign <- fityears_summ$PE$pvalue[1:8]

  # replace p-values with asterisks depending on significance level
  
  fityears_sign <- ifelse(fityears_sign < .001, "***", ifelse(fityears_sign < .01, "**", ifelse(fityears_sign < .05, "*", "")))
  
  # paste correlations and asterisks together
  
  fityears_param <- paste(format(round(fityears_param, digits = 2), nsmall = 2), fityears_sign, sep = "")
  
  # Make a path diagram to visualize the results

  replic_years_figure <- semPaths(fityears, what="std", # display the parameters on the arrows
                       nodeLabels = c("Self-Control", "Reappraisal", "Suppression", "Reduced\nPersonal Efficacy", "Need for Cognition", "Years spent\nteaching"),
                       layout = matrix(data = c(0,0,0,1,-1,-1,1,-0.3,-1,0.3,0.3,1), nrow = 6, ncol = 2), # manually set the node locations
                       sizeMan = 26, sizeMan2 = 8, shapeMan = "rectangle", label.scale = FALSE, # specify node properties
                       edge.label.cex = 1, esize = 2, # size specifications
                       edgeLabels = fityears_param, # specify the edge labels with the asterisks as previously created
                       fade = FALSE, # do not make insignificant associations invisible
                       residuals = FALSE, # do not plot residuals
                       exoCov = FALSE, # do not plot covariance between exogenous variables
                       edge.label.color = "black", posCol = "black", negCol = "black"
)
```

```{r objective1yearstable, echo=FALSE, message=FALSE, warning=FALSE}

  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  replic_years_table <- data.frame("Path" = c("NFC on Self Control", "Years spent teaching on Self Control",
                                  "NFC on Reappraisal", "NFC on Suppression",
                                  "Self Control on RPE", "Reappraisal on RPE", "Suppression on RPE", "NFC on RPE",
                                  "NFC and years spent teaching on RPE via Self Control",
                                  "NFC on RPE via Reappraisal", "NFC on RPE via Suppression",
                                  "Total Effect"),
                          "$B$" = c(fityears_summ$PE$est[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "$SE$" = c(fityears_summ$PE$se[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(fityears_summ$PE$z[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(fityears_summ$PE$pvalue[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(fityears_summ$PE$ci.lower[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(fityears_summ$PE$ci.upper[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(fityears_summ$PE$std.all[fityears_summ$PE$label != "" & fityears_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  replic_years_table[2:ncol(replic_years_table)] <- format(round(replic_years_table[2:ncol(replic_years_table)], digits = 3), nsmall = 2)

  replic_years_table <-
    kbl(replic_years_table,
        caption = "Results of the replication of Grass et al. (2018) when including years spent teaching.",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down")) %>%
    pack_rows("Direct Effects", 1, 8) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 9, 11) %>%
    pack_rows("Total Effect", 12, 12) %>%
    column_spec(1, width = "5cm") %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, NFC = Need for Cognition, RPE = reduced personal efficacy subscale of the Maslach Burnout Inventory, $SE$ = standard error.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
```

`r replic_years_table`

\newpage

## S4: Demand-resource-ratio model with the MBI subscale reduced personal efficacy

```{r exploratory1plot, echo=FALSE, message=FALSE, warning=FALSE, fig.pos="H", fig.cap="Standardized path coefficients of the demand-resource-ratio model with the MBI subscale reduced personal efficacy. * $p<.05$, ** $p<.01$, *** $p<.001$. NFC = Need for Cognition, DTH = demands too high, DTL = demands too low, DRF = demand resource fit, nfc1-4 = item parcels, dth/dtl/drf1-3 = item indicators, RPE = reduced personal efficacy."}

  # create an array of standardized parameters and an array of significances
  
  fit_explor1_param <- fit_explor1_summ$PE$std.all[1:21]
  fit_explor1_sign <- c(rep(1,14), fit_explor1_summ$PE$pvalue[17:21])

  # replace p-values with asterisks depending on significance level
  
  fit_explor1_sign <- ifelse(fit_explor1_sign < .001, "***", ifelse(fit_explor1_sign < .01, "**", ifelse(fit_explor1_sign < .05, "*", "")))
  
  # paste correlations and asterisks together
  
  fit_explor1_param <- paste(format(round(fit_explor1_param, digits = 2), nsmall = 2), fit_explor1_sign, sep = "")  

  # Visualize the results
  
  drr_rpe_plot <- semPaths(fit_explor1, what = "std",
                        nodeLabels = c("nfc1","nfc2","nfc3","nfc4","dth1","dth2","dth3","dtl1","dtl2","dtl3","drf1","drf2","drf3","rpe","NFC","DTH","DTL","DRF","RPE"),
                        layout = matrix(data = c(-1,-0.8,-0.6,-0.4,-0.8,-0.6,-0.4,-0.2,0,0.2,0.4,0.6,0.8,1,-0.8,-0.6,0,0.6,0.8,
                                                 -1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-0.5,0.5,0.5,0.5,-0.5),
                                        nrow = 19, ncol = 2),
                        residuals = FALSE, fade = FALSE,
                        edgeLabels = fit_explor1_param, # specify the edge labels with the asterisks as previously created
                        edge.label.cex = 1, esize = 2, # size of the parameters
                        edge.label.position = c(0.6,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,0.3,0.6,0.3,0.5,0.5,0.55,0.4,0.5,0.6,0.45,0.5),
                        edge.label.color = "black", edge.label.bg = TRUE, # color and background of the parameters
                        posCol = "black", negCol = "black" # color of arrows
  )
```

\newpage

## S5: Exploratory model with all relevant variables

```{r explor2table, echo=FALSE, message=FALSE, warning=FALSE}
  
  # put relevant data from the mediation into a table for reporting

  # put data into data frame

  explor2_table <- data.frame("Path" = c("Years on COVB", "Years on SCS",
                                   "COVB on DTH", "SCS on DTH", "NFC on DTH",
                                   "SCS on DRF", "NFC on DRF",
                                   "DTH on EE", "COVB on EE", "DRF on RPE",
                                   "NFC and Years on RPE via SCS and DRF",
                                   "NFC and Years on EE via SCS, COVB, and DTH",
                                   "Total Effect"),
                          "$B$" = c(fit_explor2_summ$PE$est[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "$SE$" = c(fit_explor2_summ$PE$se[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "$z$-value" = c(fit_explor2_summ$PE$z[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "$p$-value" = c(fit_explor2_summ$PE$pvalue[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "CI Lower" = c(fit_explor2_summ$PE$ci.lower[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "CI Upper" = c(fit_explor2_summ$PE$ci.upper[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          "$\\beta$" = c(fit_explor2_summ$PE$std.all[fit_explor2_summ$PE$label != "" & fit_explor2_summ$PE$label != "Contrast"]),
                          check.names = FALSE)

  # format the numbers to three digits after the decimal point
  
  explor2_table[2:ncol(explor2_table)] <- format(round(explor2_table[2:ncol(explor2_table)], digits = 3), nsmall = 2)

  explor2_table <-
    kbl(explor2_table,
        caption = "Results of the exploratory model with Covid burden.",
        booktabs = T, # no vertical lines
        escape = F, # correctly print special characters)
        align = c("l",rep("r",7))) %>% # right aligns the text in every numerical column
    kable_styling(latex_options = c("striped", "scale_down"), font_size = 11) %>%
    pack_rows("Direct Effects", 1, 10) %>% # group the rows and add a header in between
    pack_rows("Indirect Effects", 11, 12) %>%
    pack_rows("Total Effect", 13, 13) %>%
    column_spec(1, width = "5cm") %>%
    footnote(general = "$B$ = unstandardized regression coefficient, $\\beta$ = standardized regression coefficient, CI = confidence interval, COVB = Covid Burden, DTH = Demands Too High, DRF = Demand Resource Fit, MBI = Maslach Burnout Inventory, NFC = Need for Cognition, SCS = Self Control Scale, $SE$ = standard error, Years = Years spent teaching.",
             escape = F, # correctly print special characters
             threeparttable = T)# line breaks in the footnote
```

`r explor2_table`
